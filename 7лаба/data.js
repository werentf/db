const { Location, Event } = require('./models');

const locations = [
    "Стадион Лужники",
    "Баскетбольный зал Олимпийский",
    "Теннисный корт Центральный",
    "Плавательный бассейн Аквапарк",
    "Легкоатлетический манеж",
    "Шахматный клуб",
    "Гимнастический зал",
    "Боксерский ринг",
    "Фехтовальный зал",
    "Йога-студия",
    "Скалодром",
    "Сноуборд-парк"
];

const events = [
    ["2024-03-01 09:00", "Футбол", "Иванов И.И.", "Командные", 22],
    ["2024-03-01 10:00", "Баскетбол", "Петрова А.В.", "Командные", 10],
    ["2024-03-01 11:00", "Теннис", "Сидоров О.П.", "Индивидуальные", 2],
    ["2024-03-01 12:00", "Плавание", "Морозова Е.С.", "Индивидуальные", 1],
    ["2024-03-01 14:00", "Бег", "Козлов Д.Н.", "Индивидуальные", 1],
    ["2024-03-01 15:00", "Шахматы", "Белов Г.М.", "Индивидуальные", 2],
    ["2024-03-01 16:00", "Гимнастика", "Соколова И.А.", "Индивидуальные", 1],
    ["2024-03-01 17:00", "Бокс", "Волков С.П.", "Индивидуальные", 2],
    ["2024-03-02 10:00", "Фехтование", "Попов А.С.", "Индивидуальные", 2],
    ["2024-03-02 11:00", "Йога", "Новикова О.В.", "Групповые", 15],
    ["2024-03-02 12:00", "Скалолазание", "Орлов М.И.", "Индивидуальные", 1],
    ["2024-03-02 14:00", "Сноуборд", "Лебедев К.А.", "Групповые", 8]
];

async function insertData() {
    try {
        // Очистка существующих данных
        await Location.deleteMany({});
        await Event.deleteMany({});

        // Вставка локаций
        const locationDocs = await Location.insertMany(
            locations.map(name => ({ name }))
        );

        // Создание мапы для быстрого поиска id локации по имени
        const locationMap = {};
        locationDocs.forEach((doc, index) => {
            locationMap[index + 1] = doc._id;
        });

        // Вставка событий
        const eventDocs = await Event.insertMany(
            events.map((event, index) => ({
                date_time: new Date(event[0]),
                sport_type: event[1],
                coach: event[2],
                category: event[3],
                participants_count: event[4],
                location: locationMap[index + 1]
            }))
        );

        console.log('Данные успешно добавлены');
    } catch (error) {
        console.error('Ошибка при добавлении данных:', error);
        throw error;
    }
}

module.exports = { insertData }; 